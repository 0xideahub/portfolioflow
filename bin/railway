#!/usr/bin/env bash
set -e

echo "ğŸš€ Starting Railway deployment..."

# Install dependencies
echo "ğŸ“¦ Installing dependencies..."
bundle install

# Precompile assets
echo "ğŸ¨ Precompiling assets..."
bundle exec rails assets:precompile

# Run database migrations
echo "ğŸ—„ï¸ Running database migrations..."
bundle exec rails db:migrate

# Seed database if needed (only for first deployment)
if [ "$RAILWAY_ENVIRONMENT" = "production" ] && [ ! -f "/tmp/db_seeded" ]; then
  echo "ğŸŒ± Seeding database..."
  bundle exec rails db:seed
  touch /tmp/db_seeded
fi

echo "âœ… Railway deployment setup complete!" 